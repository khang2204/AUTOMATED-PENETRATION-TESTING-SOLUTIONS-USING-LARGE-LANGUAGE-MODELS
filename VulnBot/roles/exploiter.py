from typing import ClassVar

from prompts.exploiter_prompt import ExploiterPrompt
from roles.role import Role


class Exploiter(Role):

    name: str = "Vulnerability Exploiter"

    goal: str = (
        "Based on the reconnaissance and vulnerability scanning results, "
        "exploit any vulnerabilities found in the target to gain access to the system and escalate privileges."
    )

    tools: str = (
        "PlaywrightAgent, "
        "SSRFAgent, "
        "BruteForceAgent, "
        "PasswordGuessAgent, "
        "EnumPassAgent. "
    )

    prompt: ClassVar[ExploiterPrompt] = ExploiterPrompt

    def __init__(self, console, max_interactions, **kwargs):
        super().__init__(**kwargs)
        self.console = console
        self.max_interactions = max_interactions